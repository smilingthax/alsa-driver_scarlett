--- ../../alsa-kernel/pci/emu10k1/emu10k1_main.c	2007-07-19 16:36:25.000000000 +0200
+++ emu10k1_main.c	2007-07-20 12:20:12.000000000 +0200
@@ -1,3 +1,4 @@
+#define __NO_VERSION__
 /*
  *  Copyright (c) by Jaroslav Kysela <perex@suse.cz>
  *                   Creative Labs, Inc.
@@ -661,7 +662,11 @@
 	int value;
 	const struct firmware *fw_entry;
 
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(2, 5, 0)
 	if ((err = request_firmware(&fw_entry, filename, &emu->pci->dev)) != 0) {
+#else
+	if ((err = request_firmware(&fw_entry, filename, pci_name(emu->pci))) != 0) {
+#endif
 		snd_printk(KERN_ERR "firmware: %s not found. Err=%d\n",filename, err);
 		return err;
 	}
@@ -1632,7 +1637,7 @@
 	emu->synth = NULL;
 	emu->get_synth_voice = NULL;
 	/* read revision & serial */
-	emu->revision = pci->revision;
+	emu->revision = snd_pci_revision(pci);
 	pci_read_config_dword(pci, PCI_SUBSYSTEM_VENDOR_ID, &emu->serial);
 	pci_read_config_word(pci, PCI_SUBSYSTEM_ID, &emu->model);
 	snd_printdd("vendor=0x%x, device=0x%x, subsystem_vendor_id=0x%x, subsystem_id=0x%x\n",pci->vendor, pci->device, emu->serial, emu->model);
