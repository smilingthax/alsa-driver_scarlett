--- ../alsa-kernel/pci/maestro3.c	2006-11-24 13:58:46.000000000 +0100
+++ maestro3.c	2006-11-24 15:23:01.000000000 +0100
@@ -2747,8 +2747,13 @@
 		return -ENOMEM;
 	}
 
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(2, 5, 0)
 	err = request_firmware(&chip->assp_kernel_image,
 			       "ess/maestro3_assp_kernel.fw", &pci->dev);
+#else
+	err = request_firmware(&chip->assp_kernel_image,
+			       "ess/maestro3_assp_kernel.fw", pci_name(pci));
+#endif
 	if (err < 0) {
 #ifdef FIRMWARE_IN_THE_KERNEL
 		chip->assp_kernel_image = &assp_kernel;
@@ -2759,8 +2764,13 @@
 	} else
 		snd_m3_convert_from_le(chip->assp_kernel_image);
 
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(2, 5, 0)
 	err = request_firmware(&chip->assp_minisrc_image,
 			       "ess/maestro3_assp_minisrc.fw", &pci->dev);
+#else
+	err = request_firmware(&chip->assp_minisrc_image,
+			       "ess/maestro3_assp_minisrc.fw", pci_name(pci));
+#endif
 	if (err < 0) {
 #ifdef FIRMWARE_IN_THE_KERNEL
 		chip->assp_minisrc_image = &assp_minisrc;
@@ -2931,3 +2941,5 @@
 
 module_init(alsa_card_m3_init)
 module_exit(alsa_card_m3_exit)
+
+EXPORT_NO_SYMBOLS;
